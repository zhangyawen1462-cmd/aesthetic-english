# 📋 课程列表锁图标测试指南

## ✅ 已实现的功能

### 1. Business 课程列表锁图标
- **位置**: `/course/business` 页面
- **组件**: `BusinessRiverView.tsx`
- **逻辑**: 季度会员看到锁图标，年度/永久会员不显示

### 2. Cognitive 课程列表锁图标 + SAMPLE 标签
- **位置**: `/course/cognitive` 页面
- **组件**: `CognitiveCatalogView.tsx`
- **逻辑**: 
  - Sample 课程：显示 "SAMPLE" 标签，所有人可访问
  - 非 Sample 课程：季度会员看到锁图标，年度/永久会员不显示

---

## 🧪 测试步骤

### 准备工作

1. **启动开发服务器**
```bash
npm run dev
```

2. **打开浏览器开发者工具**
   - 按 `F12` 或右键 → 检查
   - 打开 Console 面板

---

### 测试场景 1: Business 课程列表

#### 1.1 季度会员（应该看到锁）

在浏览器 Console 中执行：
```javascript
localStorage.setItem('dev_tier_override', 'quarterly');
location.reload();
```

然后访问：`http://localhost:3000/course/business`

**预期结果**：
- ✅ 所有课程卡片右上角显示锁图标
- ✅ 鼠标悬停锁图标时显示 "需要年度会员" 提示
- ✅ 锁图标样式：黑色半透明圆形背景 + 白色锁图标

---

#### 1.2 年度会员（不应该看到锁）

在浏览器 Console 中执行：
```javascript
localStorage.setItem('dev_tier_override', 'yearly');
location.reload();
```

然后访问：`http://localhost:3000/course/business`

**预期结果**：
- ✅ 所有课程卡片右上角**没有**锁图标
- ✅ 可以正常点击进入课程详情页

---

#### 1.3 永久会员（不应该看到锁）

在浏览器 Console 中执行：
```javascript
localStorage.setItem('dev_tier_override', 'lifetime');
location.reload();
```

然后访问：`http://localhost:3000/course/business`

**预期结果**：
- ✅ 所有课程卡片右上角**没有**锁图标
- ✅ 可以正常点击进入课程详情页

---

### 测试场景 2: Cognitive 课程列表

#### 2.1 季度会员（Sample 课程无锁，非 Sample 有锁）

在浏览器 Console 中执行：
```javascript
localStorage.setItem('dev_tier_override', 'quarterly');
location.reload();
```

然后访问：`http://localhost:3000/course/cognitive`

**预期结果**：
- ✅ **Sample 课程**：
  - 左上角显示 "SAMPLE" 标签（浅蓝色半透明背景）
  - 右上角**没有**锁图标
  - 可以点击进入观看
  
- ✅ **非 Sample 课程**：
  - 右上角显示锁图标
  - 鼠标悬停显示 "需要年度会员" 提示
  - 点击进入后会被 ContentGate 拦截

---

#### 2.2 年度会员（所有课程无锁）

在浏览器 Console 中执行：
```javascript
localStorage.setItem('dev_tier_override', 'yearly');
location.reload();
```

然后访问：`http://localhost:3000/course/cognitive`

**预期结果**：
- ✅ **Sample 课程**：
  - 左上角显示 "SAMPLE" 标签
  - 右上角**没有**锁图标
  
- ✅ **非 Sample 课程**：
  - 右上角**没有**锁图标
  - 可以正常点击进入观看

---

#### 2.3 永久会员（所有课程无锁）

在浏览器 Console 中执行：
```javascript
localStorage.setItem('dev_tier_override', 'lifetime');
location.reload();
```

然后访问：`http://localhost:3000/course/cognitive`

**预期结果**：
- ✅ 所有课程（包括 Sample）右上角都**没有**锁图标
- ✅ 可以正常点击进入观看

---

### 测试场景 3: 未登录用户

在浏览器 Console 中执行：
```javascript
localStorage.removeItem('dev_tier_override');
localStorage.removeItem('membershipType');
location.reload();
```

**预期结果**：
- ✅ Business 课程：所有课程显示锁图标
- ✅ Cognitive 课程：
  - Sample 课程显示 "SAMPLE" 标签，无锁
  - 非 Sample 课程显示锁图标

---

## 🎨 UI 检查清单

### 锁图标样式
- [ ] 圆形背景，黑色半透明 (`bg-black/70`)
- [ ] 白色锁图标 (`text-white` 或 `text-[#E8F4F8]`)
- [ ] 毛玻璃效果 (`backdrop-blur-sm`)
- [ ] 边框 (`border border-white/30`)
- [ ] 阴影 (`shadow-lg`)
- [ ] 尺寸：`w-10 h-10`，图标 `size={18}`

### SAMPLE 标签样式（Cognitive 专属）
- [ ] 圆角胶囊形状 (`rounded-full`)
- [ ] 浅蓝色半透明背景 (`bg-[#A8C5DD]/20`)
- [ ] 毛玻璃效果 (`backdrop-blur-sm`)
- [ ] 边框 (`border border-[#A8C5DD]/40`)
- [ ] 白色文字 (`text-[#E8F4F8]`)
- [ ] 小号字体 (`text-xs`)

### Tooltip 提示
- [ ] 鼠标悬停锁图标时显示
- [ ] 黑色半透明背景 (`bg-black/90`)
- [ ] 白色文字
- [ ] 圆角 (`rounded-lg`)
- [ ] 内边距 (`px-3 py-2`)
- [ ] 文字内容：`需要年度会员`

---

## 🐛 常见问题排查

### 问题 1: 锁图标不显示

**检查步骤**：
1. 打开浏览器 Console，输入：
```javascript
console.log(localStorage.getItem('dev_tier_override'));
```
2. 确认输出是 `'quarterly'`
3. 刷新页面后再检查

---

### 问题 2: 所有会员都看到锁

**可能原因**：
- `checkVideoAccess` 函数逻辑错误
- `tier` 状态未正确传递

**检查步骤**：
1. 在 `BusinessRiverView.tsx` 或 `CognitiveCatalogView.tsx` 中添加调试：
```typescript
console.log('Current tier:', tier);
console.log('Has access:', hasAccess);
```

---

### 问题 3: SAMPLE 标签和锁图标同时显示

**预期行为**：
- Sample 课程：只显示 SAMPLE 标签，不显示锁
- 非 Sample 课程：季度会员显示锁，年度/永久会员不显示

**检查步骤**：
1. 确认课程数据中 `isSample` 字段正确
2. 检查条件渲染逻辑：
```typescript
{!hasAccess && !isSample && <Lock />}  // 锁图标
{isSample && <SAMPLE 标签>}            // SAMPLE 标签
```

---

## 📊 测试结果记录表

| 测试场景 | 会员等级 | Business 锁图标 | Cognitive 锁图标 | SAMPLE 标签 | 结果 |
|---------|---------|----------------|-----------------|------------|------|
| 场景 1.1 | 季度会员 | ✅ 显示 | ✅ 显示（非Sample） | ✅ 显示（Sample） | ⬜ 通过 / ⬜ 失败 |
| 场景 1.2 | 年度会员 | ❌ 不显示 | ❌ 不显示 | ✅ 显示（Sample） | ⬜ 通过 / ⬜ 失败 |
| 场景 1.3 | 永久会员 | ❌ 不显示 | ❌ 不显示 | ✅ 显示（Sample） | ⬜ 通过 / ⬜ 失败 |
| 场景 3 | 未登录 | ✅ 显示 | ✅ 显示（非Sample） | ✅ 显示（Sample） | ⬜ 通过 / ⬜ 失败 |

---

## 🎯 下一步

测试通过后，可以继续实施：
1. **课程详情页 ContentGate 保护**（已实现，需测试）
2. **下载功能权限控制**
3. **AI 对话次数限制**
4. **Notion 兑换码系统**

---

## 📝 备注

- 测试环境：开发模式 (`npm run dev`)
- 使用 `localStorage` 模拟会员等级切换
- 生产环境将从 Supabase 获取真实会员数据
- 所有权限逻辑集中在 `lib/permissions.ts`







