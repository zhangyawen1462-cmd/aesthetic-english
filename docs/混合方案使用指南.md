# ğŸ¯ æ··åˆæ–¹æ¡ˆä½¿ç”¨æŒ‡å—

## âœ¨ æ–°ç‰¹æ€§

### å®æ—¶åˆ‡æ¢ï¼Œæ— éœ€åˆ·æ–°ï¼

ç°åœ¨ä½ å¯ä»¥åœ¨å¼€å‘è¿‡ç¨‹ä¸­å®æ—¶åˆ‡æ¢ä¼šå‘˜ç±»å‹ï¼Œé¡µé¢ä¼šç«‹å³å“åº”ï¼Œæ— éœ€åˆ·æ–°ã€‚è¿™å¯¹äºæµ‹è¯•æœ‰çŠ¶æ€çš„åŠŸèƒ½ï¼ˆå¦‚ AI å¯¹è¯ï¼‰ç‰¹åˆ«æœ‰ç”¨ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

### 2. æ‰“å¼€å¼€å‘è€…é¢æ¿

- ç‚¹å‡»å³ä¸‹è§’é»‘è‰²åœ†å½¢æŒ‰é’®ï¼ˆçœ¼ç›å›¾æ ‡ï¼‰
- è¾“å…¥å¯†ç ï¼š`456852`
- é€‰æ‹©ä¼šå‘˜ç±»å‹

### 3. å®æ—¶æµ‹è¯•

åˆ‡æ¢ä¼šå‘˜ç±»å‹åï¼Œé¡µé¢ä¼š**ç«‹å³ç”Ÿæ•ˆ**ï¼Œæ— éœ€åˆ·æ–°ï¼

---

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1ï¼šä½¿ç”¨ Hookï¼ˆæ¨èï¼‰

åœ¨ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨ `useMembership()` Hookï¼š

```typescript
import { useMembership } from '@/context/MembershipContext';
import { checkVideoAccess } from '@/lib/permissions';

function VideoPlayer() {
  // ğŸ¯ ä¸€è¡Œä»£ç è·å–ä¼šå‘˜çŠ¶æ€
  const { tier } = useMembership();
  
  // æ£€æŸ¥æƒé™
  const canWatch = checkVideoAccess(tier, 'business', false);
  
  if (!canWatch) {
    return <div>æƒé™ä¸è¶³</div>;
  }
  
  return <video src="..." />;
}
```

**ä¼˜åŠ¿**ï¼š
- âœ… å®æ—¶å“åº”ï¼Œæ— éœ€åˆ·æ–°
- âœ… è‡ªåŠ¨åŒæ­¥æ‰€æœ‰ç»„ä»¶
- âœ… ä»£ç ç®€æ´

---

### æ–¹æ³• 2ï¼šä½¿ç”¨ ContentGateï¼ˆè‡ªåŠ¨æ¨¡å¼ï¼‰

`ContentGate` ç°åœ¨å¯ä»¥è‡ªåŠ¨è·å–ä¼šå‘˜çŠ¶æ€ï¼š

```typescript
import ContentGate from '@/components/ContentGate';

function BusinessCourse() {
  return (
    <ContentGate requiredTier="yearly" feature="Business è¯¾ç¨‹">
      <CourseContent />
    </ContentGate>
  );
}
```

**æ— éœ€æ‰‹åŠ¨ä¼ å…¥ `currentTier`ï¼**

---

### æ–¹æ³• 3ï¼šæ‰‹åŠ¨ä¼ å…¥ï¼ˆå…¼å®¹æ—§ä»£ç ï¼‰

å¦‚æœä½ éœ€è¦æ‰‹åŠ¨æ§åˆ¶ï¼Œä»ç„¶å¯ä»¥ä¼ å…¥ `currentTier`ï¼š

```typescript
<ContentGate 
  requiredTier="yearly" 
  currentTier={customTier}  // æ‰‹åŠ¨ä¼ å…¥
  feature="Business è¯¾ç¨‹"
>
  <CourseContent />
</ContentGate>
```

---

## ğŸ¨ å¼€å‘è€…é¢æ¿æ–°åŠŸèƒ½

### å®æ—¶çŠ¶æ€æ˜¾ç¤º

é¢æ¿é¡¶éƒ¨ä¼šæ˜¾ç¤ºå½“å‰æ¨¡æ‹Ÿçš„èº«ä»½ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å½“å‰æ¨¡æ‹Ÿèº«ä»½             â”‚
â”‚ LIFETIME         âœ¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¼šå‘˜ç±»å‹é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ | Badge |
|------|------|-------|
| é‡ç½®ï¼ˆçœŸå®èº«ä»½ï¼‰ | æ¸…é™¤å¼€å‘è€…è¦†ç›–ï¼Œä½¿ç”¨çœŸå®ä¼šå‘˜çŠ¶æ€ | Real |
| å­£åº¦ä¼šå‘˜ | The Season | 90 |
| å¹´åº¦ä¼šå‘˜ | The Resident | 365 |
| æ°¸ä¹…ä¼šå‘˜ | The Patron | âˆ |

### å®æ—¶ç”Ÿæ•ˆæç¤º

é¢æ¿åº•éƒ¨æ˜¾ç¤ºï¼š
```
âœ¨ å®æ—¶ç”Ÿæ•ˆï¼Œæ— éœ€åˆ·æ–°é¡µé¢
```

---

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1ï¼šæµ‹è¯• AI å¯¹è¯é™åˆ¶

**æ—§æ–¹æ¡ˆ**ï¼š
1. åˆ‡æ¢ä¼šå‘˜ç±»å‹
2. é¡µé¢åˆ·æ–°
3. å¯¹è¯å†å²ä¸¢å¤± âŒ
4. é‡æ–°å¼€å§‹å¯¹è¯

**æ–°æ–¹æ¡ˆ**ï¼š
1. å¼€å§‹ AI å¯¹è¯
2. åˆ‡æ¢ä¼šå‘˜ç±»å‹ï¼ˆå®æ—¶ç”Ÿæ•ˆï¼‰âœ…
3. å¯¹è¯å†å²ä¿ç•™
4. ç»§ç»­æµ‹è¯•ä¸åŒä¼šå‘˜çš„é™åˆ¶

---

### åœºæ™¯ 2ï¼šæµ‹è¯•è§†é¢‘æƒé™

**æ—§æ–¹æ¡ˆ**ï¼š
1. å¯¼èˆªåˆ° Business è¯¾ç¨‹é¡µé¢
2. åˆ‡æ¢ä¼šå‘˜ç±»å‹
3. é¡µé¢åˆ·æ–°
4. é‡æ–°å¯¼èˆªåˆ° Business è¯¾ç¨‹é¡µé¢ âŒ

**æ–°æ–¹æ¡ˆ**ï¼š
1. å¯¼èˆªåˆ° Business è¯¾ç¨‹é¡µé¢
2. åˆ‡æ¢ä¼šå‘˜ç±»å‹ï¼ˆå®æ—¶ç”Ÿæ•ˆï¼‰âœ…
3. é¡µé¢ç«‹å³æ˜¾ç¤º/éšè—å†…å®¹
4. æ— éœ€é‡æ–°å¯¼èˆª

---

### åœºæ™¯ 3ï¼šæµ‹è¯•ä¸‹è½½æƒé™

```typescript
import { useMembership } from '@/context/MembershipContext';
import { canDownloadRawVideo } from '@/lib/permissions';

function DownloadButton() {
  const { tier } = useMembership();
  
  // å®æ—¶å“åº”ä¼šå‘˜ç±»å‹å˜åŒ–
  if (!canDownloadRawVideo(tier)) {
    return <button disabled>å‡çº§åˆ°æ°¸ä¹…ä¼šå‘˜è§£é”</button>;
  }
  
  return <button onClick={handleDownload}>ä¸‹è½½åŸç‰‡</button>;
}
```

åˆ‡æ¢ä¼šå‘˜ç±»å‹åï¼ŒæŒ‰é’®çŠ¶æ€**ç«‹å³æ›´æ–°**ï¼

---

## ğŸ”„ Context API è¯¦è§£

### MembershipContext æä¾›çš„çŠ¶æ€

```typescript
const {
  tier,       // å½“å‰ç”Ÿæ•ˆçš„ä¼šå‘˜ç­‰çº§ï¼ˆå¼€å‘æ¨¡å¼ä¸‹æ˜¯ devTierï¼Œå¦åˆ™æ˜¯ realTierï¼‰
  realTier,   // æ•°æ®åº“ä¸­çš„çœŸå®ä¼šå‘˜ç­‰çº§
  devTier,    // å¼€å‘è€…è¦†ç›–çš„ä¼šå‘˜ç­‰çº§
  setDevTier, // è®¾ç½®å¼€å‘è€…è¦†ç›–
  isLoading   // æ˜¯å¦æ­£åœ¨åŠ è½½
} = useMembership();
```

### ç¤ºä¾‹ï¼šæ˜¾ç¤ºçœŸå®èº«ä»½å’Œæµ‹è¯•èº«ä»½

```typescript
function MembershipStatus() {
  const { tier, realTier, devTier } = useMembership();
  
  return (
    <div>
      <p>çœŸå®èº«ä»½ï¼š{getTierLabel(realTier)}</p>
      {devTier && (
        <p>æµ‹è¯•èº«ä»½ï¼š{getTierLabel(devTier)} âœ¨</p>
      )}
      <p>å½“å‰ç”Ÿæ•ˆï¼š{getTierLabel(tier)}</p>
    </div>
  );
}
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

```typescript
// 1. ä½¿ç”¨ Hook è·å–çŠ¶æ€
const { tier } = useMembership();

// 2. ä½¿ç”¨æƒé™å‡½æ•°åˆ¤æ–­
const canAccess = checkVideoAccess(tier, 'business', false);

// 3. ä½¿ç”¨ ContentGate ç»„ä»¶
<ContentGate requiredTier="yearly" feature="åŠŸèƒ½å">
  <Content />
</ContentGate>
```

### âŒ é¿å…åšæ³•

```typescript
// âŒ ä¸è¦ç›´æ¥è¯»å– localStorage
const tier = localStorage.getItem('membershipType');

// âŒ ä¸è¦ç¡¬ç¼–ç æƒé™é€»è¾‘
if (tier === 'lifetime') { ... }

// âŒ ä¸è¦åœ¨ç»„ä»¶ä¸­é‡å¤åˆ¤æ–­
{tier === 'yearly' || tier === 'lifetime' ? <Content /> : null}
```

---

## ğŸ” å®‰å…¨æ€§

### å¼€å‘ç¯å¢ƒ

- âœ… éœ€è¦å¯†ç ï¼ˆ456852ï¼‰æ‰èƒ½ä½¿ç”¨
- âœ… çŠ¶æ€ä¿å­˜åœ¨ localStorage
- âœ… åˆ·æ–°é¡µé¢åä¿æŒçŠ¶æ€

### ç”Ÿäº§ç¯å¢ƒ

- âœ… å¼€å‘è€…é¢æ¿è‡ªåŠ¨éšè—
- âœ… Context ä»ç„¶å¯ç”¨ï¼ˆç”¨äºçœŸå®ä¼šå‘˜çŠ¶æ€ï¼‰
- âœ… devTier åœ¨ç”Ÿäº§ç¯å¢ƒæ— æ•ˆ

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### Context åªåœ¨å¿…è¦æ—¶é‡æ¸²æŸ“

```typescript
// âœ… åªè®¢é˜… tier
const { tier } = useMembership();

// âŒ è®¢é˜…æ‰€æœ‰çŠ¶æ€ï¼ˆä¸å¿…è¦ï¼‰
const context = useMembership();
```

### ä½¿ç”¨ React.memo ä¼˜åŒ–

```typescript
const VideoCard = React.memo(({ video }) => {
  const { tier } = useMembership();
  // ...
});
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: åˆ‡æ¢ä¼šå‘˜ç±»å‹åæ²¡æœ‰ç«‹å³ç”Ÿæ•ˆï¼Ÿ

**A**: æ£€æŸ¥ç»„ä»¶æ˜¯å¦ä½¿ç”¨äº† `useMembership()` Hookã€‚å¦‚æœä½¿ç”¨çš„æ˜¯ `localStorage.getItem()`ï¼Œéœ€è¦æ”¹ä¸º Hookã€‚

---

### Q2: ç”Ÿäº§ç¯å¢ƒå¦‚ä½•è·å–çœŸå®ä¼šå‘˜çŠ¶æ€ï¼Ÿ

**A**: åœ¨ `MembershipContext.tsx` ä¸­ï¼Œå°† `realTier` çš„åˆå§‹åŒ–é€»è¾‘æ›¿æ¢ä¸ºä»åç«¯ API è·å–ï¼š

```typescript
useEffect(() => {
  // ä»åç«¯è·å–çœŸå®ä¼šå‘˜çŠ¶æ€
  fetch('/api/user/membership')
    .then(res => res.json())
    .then(data => setRealTier(data.tier));
}, []);
```

---

### Q3: å¦‚ä½•åœ¨æµ‹è¯•é¡µé¢æ˜¾ç¤ºå¼€å‘è€…æ¨¡å¼çŠ¶æ€ï¼Ÿ

**A**: ä½¿ç”¨ `devTier` åˆ¤æ–­ï¼š

```typescript
const { devTier } = useMembership();

{devTier && (
  <span className="badge">
    å¼€å‘è€…æ¨¡å¼æ¿€æ´»
  </span>
)}
```

---

### Q4: å¦‚ä½•é‡ç½®åˆ°çœŸå®èº«ä»½ï¼Ÿ

**A**: ç‚¹å‡»"é‡ç½®ï¼ˆçœŸå®èº«ä»½ï¼‰"æŒ‰é’®ï¼Œæˆ–è€…ï¼š

```typescript
const { setDevTier } = useMembership();
setDevTier(null); // æ¸…é™¤å¼€å‘è€…è¦†ç›–
```

---

## ğŸ‰ æ€»ç»“

### æ··åˆæ–¹æ¡ˆçš„ä¼˜åŠ¿

| ç‰¹æ€§ | æ—§æ–¹æ¡ˆ | æ··åˆæ–¹æ¡ˆ |
|------|--------|---------|
| **åˆ‡æ¢é€Ÿåº¦** | ~5 ç§’ï¼ˆåˆ·æ–°é¡µé¢ï¼‰ | ~0.1 ç§’ï¼ˆå®æ—¶ï¼‰ |
| **çŠ¶æ€ä¿æŒ** | âŒ ä¸¢å¤± | âœ… ä¿ç•™ |
| **ä»£ç å¤æ‚åº¦** | ç®€å• | ä¸­ç­‰ |
| **å¼€å‘æ•ˆç‡** | â­â­â­ | â­â­â­â­â­ |
| **å®‰å…¨æ€§** | â­â­â­â­ | â­â­â­â­â­ |

### å…³é”®æ”¹è¿›

1. âœ… **å®æ—¶å“åº”** - æ— éœ€åˆ·æ–°é¡µé¢
2. âœ… **çŠ¶æ€ä¿æŒ** - AI å¯¹è¯å†å²ä¸ä¸¢å¤±
3. âœ… **ç»Ÿä¸€ç®¡ç†** - Context + Hook æ¶æ„
4. âœ… **å¯†ç ä¿æŠ¤** - é˜²æ­¢è¯¯æ“ä½œ
5. âœ… **å‘åå…¼å®¹** - æ”¯æŒæ‰‹åŠ¨ä¼ å…¥ tier

---

**ç«‹å³ä½“éªŒ**ï¼š`npm run dev` â†’ è®¿é—® `http://localhost:3000/test-permissions`







